{"version":3,"sources":["../../../../server/lib/incremental-cache/file-system-cache.ts"],"names":["LRUCache","path","FileSystemCache","constructor","ctx","fs","flushToDisk","serverDistDir","appDir","_appDir","maxMemoryCacheSize","memoryCache","max","length","value","JSON","kind","stringify","props","Error","html","pageData","get","key","data","filePath","htmlPath","isAppPath","getFsPath","readFile","parse","mtime","stat","lastModified","getTime","set","_","Date","now","mkdir","dirname","writeFile","pathname","join","err"],"mappings":"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"}