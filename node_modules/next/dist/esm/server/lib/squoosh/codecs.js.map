{"version":3,"sources":["../../../../server/lib/squoosh/codecs.ts"],"names":["promises","fsp","path","instantiateEmscriptenWasm","pathify","mozEnc","mozEncWasm","resolve","__dirname","mozDec","mozDecWasm","webpEnc","webpEncWasm","webpDec","webpDecWasm","avifEnc","avifEncWasm","avifDec","avifDecWasm","pngEncDec","pngEncDecWasm","pngEncDecInit","default","readFile","oxipng","oxipngWasm","oxipngInit","resize","resizeWasm","resizeInit","rotateWasm","ImageData","globalThis","resizeNameToIndex","name","Error","resizeWithAspect","input_width","input_height","target_width","target_height","width","height","Math","round","preprocessors","description","instantiate","buffer","method","premultiply","linearRGB","imageData","cleanup","defaultOptions","fitMethod","rotate","numRotations","degrees","sameDimensions","size","instance","WebAssembly","memory","exports","additionalPagesNeeded","ceil","byteLength","grow","view","Uint8ClampedArray","set","slice","codecs","mozjpeg","extension","detectors","dec","enc","defaultEncoderOptions","quality","baseline","arithmetic","progressive","optimize_coding","smoothing","color_space","quant_table","trellis_multipass","trellis_opt_zero","trellis_opt_table","trellis_loops","auto_subsample","chroma_subsample","separate_chroma_quality","chroma_quality","autoOptimize","option","min","max","webp","target_size","target_PSNR","sns_strength","filter_strength","filter_sharpness","filter_type","partitions","segments","pass","show_compressed","preprocessing","autofilter","partition_limit","alpha_compression","alpha_filtering","alpha_quality","lossless","exact","image_hint","emulate_jpeg_size","thread_level","low_memory","near_lossless","use_delta_palette","use_sharp_yuv","avif","cqLevel","cqAlphaLevel","denoiseLevel","tileColsLog2","tileRowsLog2","speed","subsample","chromaDeltaQ","sharpness","tune","decode","encode","opts","simplePng","Uint8Array","optimise","level"],"mappings":"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"}